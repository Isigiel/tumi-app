<!--
  ~     The TUMi app provides a modern way of managing events for an esn section.
  ~     Copyright (C) 2019  Lukas Heddendorp
  ~
  ~     This program is free software: you can redistribute it and/or modify
  ~     it under the terms of the GNU General Public License as published by
  ~     the Free Software Foundation, either version 3 of the License, or
  ~     (at your option) any later version.
  ~
  ~     This program is distributed in the hope that it will be useful,
  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~     GNU General Public License for more details.
  ~
  ~     You should have received a copy of the GNU General Public License
  ~     along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<h2 class="mat-display-4 no-margin">Users related to this event</h2>
<a href="{{ tutorEmail }}" mat-flat-button target="_blank">Send Mail to Tutors</a>
<!--<ng-container *ngIf="!(isAdmin$ | async); else adminTutors">
  <p><strong>Tutors on this event</strong></p>
  <mat-list>
    <mat-list-item *ngFor="let user of event.tutorUsers">
      {{ user.firstName }} {{ user.lastName }} ({{ user.email }})
    </mat-list-item>
  </mat-list>
</ng-container>
<ng-template #adminTutors>
  <p><strong>Tutors on this event</strong> (Click Tutor to remove them from the event)</p>
  <mat-action-list>
    <button (click)="kickTutor(user)" *ngFor="let user of event.tutorUsers" mat-list-item>
      {{ user.firstName }} {{ user.lastName }} ({{ user.email }})
    </button>
  </mat-action-list>
</ng-template>-->
<table mat-table [dataSource]="event.tutorUsers" [trackBy]="trackById" style="width: 100%;">

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef> Name </th>
    <td mat-cell *matCellDef="let element"> {{element.firstName}} {{element.lastName}} </td>
  </ng-container>

  <!-- Weight Column -->
  <ng-container matColumnDef="mail">
    <th mat-header-cell *matHeaderCellDef> Mail </th>
    <td mat-cell *matCellDef="let element"> {{element.email}} </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['name', 'mail']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['name', 'mail'];"></tr>
</table>
<p style="margin-top: 2rem;"><strong>Students registered for this event</strong></p>
<a href="{{ participantEmail }}" mat-flat-button target="_blank">Send Mail to Participants</a>
<table mat-table [dataSource]="event.userSignups" [trackBy]="trackById" style="width: 100%;">

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef> Name </th>
    <td mat-cell *matCellDef="let element"> {{element.user.firstName}} {{element.user.lastName}} </td>
  </ng-container>

  <!-- Weight Column -->
  <ng-container matColumnDef="mail">
  <th mat-header-cell *matHeaderCellDef> Mail </th>
  <td mat-cell *matCellDef="let element"> {{element.user.email}} </td>
</ng-container>

  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef> Actions </th>
    <td mat-cell *matCellDef="let element"> <button mat-flat-button (click)="collectPayment(element.user)" *ngIf="!element.hasPayed && event.hasFee">
      Confirm Payment
    </button>
      <button mat-button (click)="removeUser(element.user)" *ngIf="isAdmin$ | async">
        Remove from Event
      </button>
      <button mat-button (click)="registerUser(element.user)" *ngIf="!element.hasAttended">
        Confirm Attendance
      </button>
      <button mat-button (click)="deregisterUser(element.user)" *ngIf="element.hasAttended">
        Did not attend
      </button> </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="['name', 'mail', 'actions']"></tr>
  <tr mat-row *matRowDef="let row; columns: ['name', 'mail', 'actions'];"></tr>
</table>
<!--<div fxLayout="column" fxLayoutGap="1.5rem">
  <div
    *ngFor="let registration of event.userSignups; trackBy: trackById"
    fxLayout="column"
    fxLayout.gt-sm="row"
    fxLayoutGap=".5rem"
    fxLayoutAlign="start start"
    fxLayoutAlign.gt-sm="start center"
  >
    <div fxLayout="row" fxLayoutGap=".5rem" fxLayoutAlign="start center">
      <mat-icon
        [svgIcon]="registration.hasAttended ? 'checked' : 'cancel'"
        [style.color]="registration.hasAttended ? 'green' : 'red'"
      ></mat-icon>
      <span>{{ registration.user.firstName }} {{ registration.user.lastName }} ({{ registration.user.email }})</span>
    </div>
    <div fxLayout="row" fxLayoutGap=".5rem">
      <button
        mat-flat-button
        (click)="collectPayment(registration.user)"
        *ngIf="!registration.hasPayed && event.hasFee"
      >
        Confirm Payment
      </button>
      <button
        mat-flat-button
        (click)="removeUser(registration.user)"
        *ngIf="isAdmin$ | async"
      >
        Remove from Event
      </button>
      <button mat-flat-button (click)="registerUser(registration.user)" *ngIf="!registration.hasAttended">
        Confirm Attendance
      </button>
      <button mat-flat-button (click)="deregisterUser(registration.user)" *ngIf="registration.hasAttended">
        Did not attend
      </button>
    </div>
  </div>
</div>-->
