<!--
  ~     The TUMi app provides a modern way of managing events for an esn section.
  ~     Copyright (C) 2020  Lukas Heddendorp
  ~
  ~     This program is free software: you can redistribute it and/or modify
  ~     it under the terms of the GNU General Public License as published by
  ~     the Free Software Foundation, either version 3 of the License, or
  ~     (at your option) any later version.
  ~
  ~     This program is distributed in the hope that it will be useful,
  ~     but WITHOUT ANY WARRANTY; without even the implied warranty of
  ~     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  ~     GNU General Public License for more details.
  ~
  ~     You should have received a copy of the GNU General Public License
  ~     along with this program.  If not, see <https://www.gnu.org/licenses/>.
  -->

<form
  [formGroup]="eventForm"
  class="grid-form"
  gdAuto
  gdColumns.gt-md="repeat(4, 1fr)"
  gdColumns.gt-xs="repeat(2, 1fr)"
  gdColumns.xs="1fr"
  gdGap="1rem"
>
  <mat-form-field gdColumn.gt-xs="span 2">
    <mat-label>Event Name</mat-label>
    <input formControlName="name" matInput/>
  </mat-form-field>
  <div fxLayout="row" fxLayoutGap="2rem" gdColumn.gt-xs="span 2">
    <mat-form-field fxFlex>
      <mat-label>Icon for your event</mat-label>
      <input formControlName="icon" matInput/>
      <mat-hint>Try some words and see if they match your event (go to icons8.com for a better search)</mat-hint>
    </mat-form-field>
    <div fxFlex.gt-sm>
      <img [appIconSrc]="icon$ | async" height="64px" width="64px"/>
    </div>
  </div>
  <mat-form-field>
    <mat-label>Choose the starting date</mat-label>
    <input
      [matDatepicker]="startPicker"
      [max]="eventForm.get('end').valueChanges | async"
      formControlName="start"
      matInput
    />
    <mat-datepicker-toggle [for]="startPicker" matSuffix></mat-datepicker-toggle>
    <mat-datepicker #startPicker></mat-datepicker>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Time your event starts</mat-label>
    <input formControlName="startTime" matInput/>
    <mat-hint>Enter your time in <strong>24hr format</strong></mat-hint>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Choose the ending date</mat-label>
    <input
      [matDatepicker]="endPicker"
      [min]="eventForm.get('start').valueChanges | async"
      formControlName="end"
      matInput
    />
    <mat-datepicker-toggle [for]="endPicker" matSuffix></mat-datepicker-toggle>
    <mat-datepicker #endPicker></mat-datepicker>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Time your event ends</mat-label>
    <input formControlName="endTime" matInput/>
    <mat-hint>Enter your time in <strong>24hr format</strong></mat-hint>
  </mat-form-field>
  <mat-form-field gdColumn.gt-xs="span 2" gdGridAlign="stretch end" gdRow="span 3">
    <mat-label>Event description</mat-label>
    <textarea formControlName="description" matInput rows="6"></textarea>
  </mat-form-field>
  <mat-form-field gdColumn.gt-xs="span 2" gdGridAlign="stretch end" gdRow="span 3">

    <mat-label>Notes for Tutors</mat-label>
    <textarea formControlName="runningNotes" matInput rows="6"></textarea>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Participant cost for the event</mat-label>
    <input formControlName="price" matInput type="number"/>
    <mat-icon matSuffix svgIcon="euro"></mat-icon>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Full cost of the Event</mat-label>
    <input formControlName="fullCost" matInput type="number"/>
    <mat-icon matSuffix svgIcon="euro"></mat-icon>
    <mat-hint>What will be given to the Tutor</mat-hint>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Number of spots</mat-label>
    <input formControlName="participantSpots" matInput type="number"/>
  </mat-form-field>
  <mat-form-field>
    <mat-label>Number of Tutors</mat-label>
    <input formControlName="tutorSpots" matInput type="number"/>
  </mat-form-field>
  <mat-slide-toggle formControlName="isExternal"
    >External Event <small>(Not organized by TUMi)</small>
  </mat-slide-toggle>
  <mat-slide-toggle formControlName="isInternal">Internal Event <small>(Only for Tutors)</small></mat-slide-toggle>
  <mat-form-field gdColumn.gt-xs="span 2">
    <mat-label>Singup Link</mat-label>
    <input formControlName="signupLink" matInput type="href"/>
    <mat-hint>Link where users can sign up for external events</mat-hint>
  </mat-form-field>
  <mat-slide-toggle formControlName="hasOnlineSignup">Online Signup</mat-slide-toggle>
  <mat-slide-toggle formControlName="isTicketTracker">Only track ticket number</mat-slide-toggle>
  <mat-slide-toggle formControlName="hasFee">Payment necessary</mat-slide-toggle>
  <div></div>
  <mat-slide-toggle formControlName="isVisibleInternally">Event is visible to tutors</mat-slide-toggle>
  <mat-slide-toggle formControlName="isVisiblePublicly">Event is publicly visible</mat-slide-toggle>
  <button (click)="saveChanges()" [disabled]="eventForm.invalid" color="primary" mat-stroked-button>
    Save changes
  </button>
  <button mat-stroked-button routerLink="../..">Discard changes</button>
</form>
